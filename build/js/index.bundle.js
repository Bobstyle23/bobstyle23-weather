(()=>{"use strict";var e={283:(e,t,r)=>{r.d(t,{O:()=>a});const a={overcast:[0,1],"partly-cloudy":[2,3],fog:[45,48],drizzle:[51,53,55],rain:[61,63,65,80,81,82],snow:[71,73,75],storm:[95,96,99]}},359:(e,t,r)=>{r.d(t,{X:()=>a});class a{constructor(){}async fetchLocationData(e){const t=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${e}`);return await t.json()}async fetchWeatherData(e){const{latitude:t,longitude:r,temperatureUnit:a="celsius",windspeed:i="kmh",precipitation:n="mm"}=e,o=`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${r}&hourly=temperature_2m,apparent_temperature,relative_humidity_2m,precipitation,weathercode,windspeed_10m,cloudcover,uv_index,pressure_msl,visibility,\n&daily=temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,sunrise,sunset,precipitation_sum,weathercode,uv_index_max\n&temperature_unit=${a}\n&windspeed_unit=${i}\n&precipitation_unit=${n}\n&timezone=auto`,s=await fetch(o);return await s.json()}async fetchUsersCountry(e,t){const r=await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${e}&lon=${t}&limit=1&appid=47ba0bbf5c9aa13204ad8adb08cb800f`);return(await r.json())[0]}async fetchFullCountryName(e){const t=await fetch(`https://restcountries.com/v3.1/alpha/${e}`);return await t.json()}async fetchUsersLocation(){const e=await fetch("https://ipapi.co/json/");return await e.json()}}},886:(e,t,r)=>{r.d(t,{BF:()=>i});var a=r(283);new class{constructor(){this.observables=[]}subscribe(e){this.observables.push(e)}unsubscribe(e){this.observables=this.observables.filter(t=>t!==e)}notify(e){this.observables.forEach(t=>t(e))}};const i=new class{constructor(){}getWeatherGroupByCode(e){for(const[t,r]of Object.entries(a.O))if(r.includes(e))return t;return"unknown"}debounce(e,t){let r;return function(...a){clearTimeout(r),r=setTimeout(()=>e(...a),t)}}}}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=r(359),i=r(886);const n=new WeakMap;class o{constructor(){this.cacheDOM(),this.bindEvents(),this.loading=!1,this.getUsersLocation(),this.getUsersTime()}static weatherData=new a.X;static searchValue="";static userCurrentData={latitude:null,longitude:null,dateAndTime:null,country:null,city:null};set locationData(e){n.set(this,e)}get locationData(){return n.get(this)}cacheDOM(){this.searchField=document.querySelector(".search__field"),this.searchBtn=document.querySelector(".search__btn"),this.currentWeatherBgContainer=document.querySelector(".current__bg-img"),this.currentWeatherBgLoading=document.querySelector(".current__loading"),this.currentCity=document.querySelector(".current__city"),this.currentDate=document.querySelector(".current__date"),this.currentDegree=document.querySelector(".current__weather-degree"),this.currentWeatherIcon=document.querySelector(".current__weather-icon"),this.currentUnitValues=document.querySelectorAll(".current__unit--value"),this.forecastUnits=document.querySelectorAll(".forecast__unit"),this.daysDropdown=document.querySelectorAll('[data-type="days"] .select__dropdown li'),this.daysDropdownDefault=document.querySelector('[data-type="days"] .selected__value'),this.dailyForecastUnit=document.querySelector(".forecast--daily .forecast__units"),this.hourlyForecastUnit=document.querySelector(".forecast--hourly .forecast__units"),this.initialSelectedDay=this.daysDropdownDefault.textContent}loadingState(e){this.loading=e,this.savedForecastUnits||(this.savedForecastUnits=[...this.forecastUnits].map(e=>[...e.children].map(e=>e.cloneNode(!0)))),this.savedCurrentUnitValues||(this.savedCurrentUnitValues=Array.from(this.currentUnitValues).map(e=>e.cloneNode(!0))),e?(this.currentWeatherBgContainer.setAttribute("hidden",""),this.currentWeatherBgLoading.removeAttribute("hidden"),this.currentUnitValues.forEach(e=>{e.textContent="-"}),this.forecastUnits.forEach(e=>e.innerHTML=""),this.daysDropdownDefault.textContent="-"):(this.currentWeatherBgContainer.removeAttribute("hidden"),this.currentWeatherBgLoading.setAttribute("hidden",""),this.forecastUnits.forEach((e,t)=>{this.savedForecastUnits[t].forEach(t=>e.appendChild(t))}))}bindEvents(){const e=i.BF.debounce(e=>{this.getLocationData(e.target.value)},500);this.searchField.addEventListener("input",t=>{o.searchValue=t.target.value,e(t)}),this.searchBtn.addEventListener("click",()=>this.getWeatherDataByLocation({latitude:this.locationData[0].latitude,longitude:this.locationData[0].longitude}))}getLocationData(e){o.weatherData.fetchLocationData(e).then(e=>{this.locationData=e.results,console.log(e.results)})}getWeatherDataByLocation(e){o.weatherData.fetchWeatherData(e).then(e=>{o.weatherData.fetchUsersCountry(e.latitude,e.longitude).then(e=>{console.log(e)}),console.log(e)})}async getUsersLocation(){try{this.loadingState(!0);const e=await o.weatherData.fetchUsersLocation();o.userCurrentData.latitude=e.latitude,o.userCurrentData.longitude=e.longitude,o.userCurrentData.country=e.country_name,o.userCurrentData.city=e.region,await this.updateCurrentUserWeather(),this.loadingState(!1)}catch(e){console.error(e),this.loadingState(!1)}}getUsersTime(){const e=(new Date).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"numeric"});o.userCurrentData.dateAndTime=e.split(",").slice(0,3)}static#e(e,t="short"){return e.daily.time.map(e=>new Date(e).toLocaleDateString("en-US",{weekday:t}))}static#t(e){return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}async updateCurrentUserWeather(){try{const{latitude:e,longitude:t}=o.userCurrentData,r=await o.weatherData.fetchWeatherData({latitude:e,longitude:t});console.log(r);const a=new Date,n=a.toLocaleDateString("en-CA"),s=new Date(a.getTime()+324e5);s.setMinutes(0,0,0);const u=s.toISOString().slice(0,13)+":00",c=r.hourly.time.indexOf(u),l=r.daily.time.indexOf(n);if(console.log(l,n,u,c),-1!==c){const e={temperature:r.hourly.temperature_2m[c],apparentTemperature:r.hourly.apparent_temperature[c],humidity:r.hourly.relative_humidity_2m[c],precipitation:r.hourly.precipitation[c],weatherCode:r.hourly.weathercode[c],windSpeed:r.hourly.windspeed_10m[c],cloudCover:r.hourly.cloudcover[c],uvIndex:r.hourly.uv_index[c],sunrise:r.daily.sunrise[l],sunset:r.daily.sunset[l],pressure:r.hourly.pressure_msl[c],visibility:r.hourly.visibility[c]},t=o.#e(r),a=o.#e(r,"long").map(e=>e);this.daysDropdown.forEach((e,t)=>{e.textContent=a[t],e.dataset.value=a[t].toLowerCase()}),this.daysDropdownDefault.textContent=a[0];const n={dailyTemperatures:{high:r.daily.temperature_2m_max.map(e=>e),low:r.daily.temperature_2m_min.map(e=>e)},days:t,weatherCodes:r.daily.weathercode.map(e=>e)},s=n.days.map((e,t)=>({day:e,highTemp:n.dailyTemperatures.high[t],lowTemp:n.dailyTemperatures.low[t],code:n.weatherCodes[t]})).map(e=>`<article class="forecast__unit"> <p class="forecast__unit--day">${e.day}</p> \n        <img class="forecast__unit--icon" src="./img/icon-${i.BF.getWeatherGroupByCode(e.code)}.webp" /> <div>\n        <p class="forecast__unit--high">${e.highTemp.toFixed(0)}&deg;</p>\n        <p class="forecast__unit--low">${e.lowTemp.toFixed(0)}&deg;</p>\n        </div></article>`);this.dailyForecastUnit.innerHTML=s.join("");const u=r.hourly.time.slice(c+1,c+9);u.map(e=>{if(-1!==r.hourly.time.indexOf(e)){const e=u.map(e=>{const t=r.hourly.time.indexOf(e);return-1!==t?{temperature:r.hourly.temperature_2m[t],weatherCode:r.hourly.weathercode[t],time:r.hourly.time[t]}:null}).filter(Boolean),t=e.map(e=>{const t=new Date(e.time).toLocaleString("en-US",{hour:"numeric",hours12:!0});return`<article class="forecast__unit forecast__unit--hourly"><img class="forecast__unit--hourly-icon" src="./img/icon-${i.BF.getWeatherGroupByCode(e.weatherCode)}.webp"/><p class="forecast__unit--hourly-time">${t}</p><p class="forecast__unit--hourly-temp">${e.temperature.toFixed()}&deg;</p></article>`});this.hourlyForecastUnit.innerHTML=t.join("")}});const h=[`${o.#t(e.sunrise)}`,`${e.apparentTemperature.toFixed(0)}&deg;`,`${e.humidity}%`,`${e.windSpeed} ${r.hourly_units.windspeed_10m}`,`${e.precipitation} ${r.hourly_units.precipitation}`,`${Math.round(1*e.uvIndex).toFixed()}`,`${Number(e.pressure.toFixed(0)).toLocaleString("en-US")} ${r.hourly_units.pressure_msl}`,`${Math.floor(e.visibility/1e3)} km`,`${o.#t(e.sunset)}`];this.currentDegree.innerHTML=`${e.temperature.toFixed(0)}&deg;`;const d=i.BF.getWeatherGroupByCode(e.weatherCode);this.currentWeatherIcon.setAttribute("src",`./img/icon-${d}.webp`),this.currentUnitValues.forEach((e,t)=>{e.innerHTML=h[t]})}this.currentCity.textContent=`${o.userCurrentData.city}, ${o.userCurrentData.country}`,this.currentDate.textContent=o.userCurrentData.dateAndTime}catch(e){console.error("Error updating current user weather:",e)}}}new o})();