(()=>{"use strict";var e={283:(e,t,r)=>{r.d(t,{O:()=>a});const a={overcast:[0,1],"partly-cloudy":[2,3],fog:[45,48],drizzle:[51,53,55],rain:[61,63,65,80,81,82],snow:[71,73,75],storm:[95,96,99]}},359:(e,t,r)=>{r.d(t,{X:()=>a});class a{constructor(){}async fetchLocationData(e){const t=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${e}`);return await t.json()}async fetchWeatherData(e){const{latitude:t,longitude:r,temperatureUnit:a="celsius",windspeed:o="kmh",precipitation:n="mm"}=e,i=`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${r}&hourly=temperature_2m,apparent_temperature,relative_humidity_2m,precipitation,weathercode,windspeed_10m,cloudcover,uv_index\n&daily=temperature_2m_max,temperature_2m_min,apparent_temperature_max,apparent_temperature_min,sunrise,sunset,precipitation_sum,weathercode,uv_index_max\n&temperature_unit=${a}\n&windspeed_unit=${o}\n&precipitation_unit=${n}\n&timezone=auto`,s=await fetch(i);return await s.json()}async fetchUsersCountry(e,t){const r=await fetch(`https://api.openweathermap.org/geo/1.0/reverse?lat=${e}&lon=${t}&limit=1&appid=47ba0bbf5c9aa13204ad8adb08cb800f`);return(await r.json())[0]}async fetchFullCountryName(e){const t=await fetch(`https://restcountries.com/v3.1/alpha/${e}`);return(await t.json())[0]}}},886:(e,t,r)=>{r.d(t,{BF:()=>o});var a=r(283);new class{constructor(){this.observables=[]}subscribe(e){this.observables.push(e)}unsubscribe(e){this.observables=this.observables.filter(t=>t!==e)}notify(e){this.observables.forEach(t=>t(e))}};const o=new class{constructor(){}getWeatherGroupByCode(e){for(const[t,r]of Object.entries(a.O))if(r.includes(e))return t;return"unknown"}debounce(e,t){let r;return function(...a){clearTimeout(r),r=setTimeout(()=>e(...a),t)}}}}},t={};function r(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=r(359),o=r(886);const n=new WeakMap;class i{constructor(){this.cacheDOM(),this.bindEvents(),this.loading=!1,this.getUsersLocation(),this.getUsersTime()}static weatherData=new a.X;static searchValue="";static userCurrentData={latitude:null,longitude:null,dateAndTime:null};set locationData(e){n.set(this,e)}get locationData(){return n.get(this)}cacheDOM(){this.searchField=document.querySelector(".search__field"),this.searchBtn=document.querySelector(".search__btn"),this.currentWeatherBgContainer=document.querySelector(".current__bg-img"),this.currentWeatherBgLoading=document.querySelector(".current__loading"),this.currentCity=document.querySelector(".current__city"),this.currentDate=document.querySelector(".current__date"),this.currentDegree=document.querySelector(".current__weather-degree"),this.currentWeatherIcon=document.querySelector(".current__weather-icon"),this.currentUnitValues=document.querySelectorAll(".current__unit--value"),this.forecastUnits=document.querySelectorAll(".forecast__unit"),this.daysDropdown=document.querySelectorAll('[data-type="days"] .select__dropdown li'),this.daysDropdownDefault=document.querySelector('[data-type="days"] .selected__value'),this.dailyForecastUnit=document.querySelector(".forecast--daily .forecast__units"),this.hourlyForecastUnit=document.querySelector(".forecast--hourly .forecast__units"),this.initialSelectedDay=this.daysDropdownDefault.textContent}loadingState(e){this.loading=e,this.savedForecastUnits||(this.savedForecastUnits=[...this.forecastUnits].map(e=>[...e.children].map(e=>e.cloneNode(!0)))),this.savedCurrentUnitValues||(this.savedCurrentUnitValues=Array.from(this.currentUnitValues).map(e=>e.cloneNode(!0))),e?(this.currentWeatherBgContainer.setAttribute("hidden",""),this.currentWeatherBgLoading.removeAttribute("hidden"),this.currentUnitValues.forEach(e=>{e.textContent="-"}),this.forecastUnits.forEach(e=>e.innerHTML=""),this.daysDropdownDefault.textContent="-"):(this.currentWeatherBgContainer.removeAttribute("hidden"),this.currentWeatherBgLoading.setAttribute("hidden",""),this.forecastUnits.forEach((e,t)=>{this.savedForecastUnits[t].forEach(t=>e.appendChild(t))}))}bindEvents(){const e=o.BF.debounce(e=>{this.getLocationData(e.target.value)},500);this.searchField.addEventListener("input",t=>{i.searchValue=t.target.value,e(t)}),this.searchBtn.addEventListener("click",()=>this.getWeatherDataByLocation({latitude:this.locationData[0].latitude,longitude:this.locationData[0].longitude}))}getLocationData(e){i.weatherData.fetchLocationData(e).then(e=>{this.locationData=e.results,console.log(e.results)})}getWeatherDataByLocation(e){i.weatherData.fetchWeatherData(e).then(e=>{console.log(e)})}getUsersLocation(){try{this.loadingState(!0),navigator.geolocation?navigator.geolocation.getCurrentPosition(async e=>{const t=e.coords.latitude,r=e.coords.longitude;i.userCurrentData.latitude=t,i.userCurrentData.longitude=r,this.loadingState(!0),await this.updateCurrentUserWeather(),this.loadingState(!1)},e=>{switch(e.code){case e.PERMISSION_DENIED:console.error("User denied the request for geolocation");break;case e.POSITION_UNAVAILABLE:console.error("Location information unavailable");break;case e.TIMEOUT:console.error("The request to get user location timed out");break;default:console.error("Unknown error occured.")}this.loadingState(!1)}):(console.error("geolocation is not supporter by this browser"),this.loadingState(!1))}catch(e){console.log(e),this.loadingState(!1)}}getUsersTime(){const e=(new Date).toLocaleString(void 0,{weekday:"long",year:"numeric",month:"short",day:"numeric",hour:"numeric"});i.userCurrentData.dateAndTime=e.split(",").slice(0,3)}async updateCurrentUserWeather(){try{const{latitude:e,longitude:t}=i.userCurrentData,r=await i.weatherData.fetchWeatherData({latitude:e,longitude:t});console.log(r),(new Date).toLocaleString();const a=new Date,n=a.toISOString().slice(0,10),s=new Date(a.getTime()+324e5);s.setMinutes(0,0,0);const c=s.toISOString().slice(0,13)+":00";console.log(c);const u=r.hourly.time.indexOf(c);if(r.daily.time.indexOf(n),-1!==u){const e={temperature:r.hourly.temperature_2m[u],apparentTemperature:r.hourly.apparent_temperature[u],humidity:r.hourly.relative_humidity_2m[u],precipitation:r.hourly.precipitation[u],weatherCode:r.hourly.weathercode[u],windSpeed:r.hourly.windspeed_10m[u],cloudCover:r.hourly.cloudcover[u],uvIndex:r.hourly.uv_index[u]},t=r.daily.time.map(e=>new Date(e).toLocaleDateString("en-US",{weekday:"short"})),a=r.daily.time.map(e=>new Date(e).toLocaleDateString("en-US",{weekday:"long"})).map(e=>e);this.daysDropdown.forEach((e,t)=>{e.textContent=a[t],e.dataset.value=a[t].toLowerCase()}),this.daysDropdownDefault.textContent=a[0];const n={dailyTemperatures:{high:r.daily.temperature_2m_max.map(e=>e),low:r.daily.temperature_2m_min.map(e=>e)},days:t,weatherCodes:r.daily.weathercode.map(e=>e)},i=n.days.map((e,t)=>({day:e,highTemp:n.dailyTemperatures.high[t],lowTemp:n.dailyTemperatures.low[t],code:n.weatherCodes[t]})).map(e=>`<article class="forecast__unit"> <p class="forecast__unit--day">${e.day}</p> \n        <img class="forecast__unit--icon" src="./img/icon-${o.BF.getWeatherGroupByCode(e.code)}.webp" /> <div>\n        <p class="forecast__unit--high">${e.highTemp.toFixed(0)}&deg;</p>\n        <p class="forecast__unit--low">${e.lowTemp.toFixed(0)}&deg;</p>\n        </div></article>`);this.dailyForecastUnit.innerHTML=i.join("");const s=r.hourly.time.slice(u+1,u+9);s.map(e=>{if(-1!==r.hourly.time.indexOf(e)){const e=s.map(e=>{const t=r.hourly.time.indexOf(e);return-1!==t?{temperature:r.hourly.temperature_2m[t],weatherCode:r.hourly.weathercode[t],time:r.hourly.time[t]}:null}).filter(Boolean),t=e.map(e=>{const t=new Date(e.time).toLocaleString("en-US",{hour:"numeric",hours12:!0});return`<article class="forecast__unit forecast__unit--hourly"><img class="forecast__unit--hourly-icon" src="./img/icon-${o.BF.getWeatherGroupByCode(e.weatherCode)}.webp"/><p class="forecast__unit--hourly-time">${t}</p><p class="forecast__unit--hourly-temp">${e.temperature.toFixed()}&deg;</p></article>`});this.hourlyForecastUnit.innerHTML=t.join("")}});const c=[`${e.apparentTemperature.toFixed(0)}&deg;`,`${e.humidity}%`,`${e.windSpeed} ${r.hourly_units.windspeed_10m}`,`${e.precipitation} ${r.hourly_units.precipitation}`];this.currentDegree.innerHTML=`${e.temperature.toFixed(0)}&deg;`;const l=o.BF.getWeatherGroupByCode(e.weatherCode);this.currentWeatherIcon.setAttribute("src",`./img/icon-${l}.webp`),this.currentUnitValues.forEach((e,t)=>{e.innerHTML=c[t]})}const l=await i.weatherData.fetchUsersCountry(e,t),d=await i.weatherData.fetchFullCountryName(l.country);this.currentCity.textContent=`${l.name}, ${d.name.common}`,this.currentDate.textContent=i.userCurrentData.dateAndTime}catch(e){console.error("Error updating current user weather:",e)}}}new i})();